\ProvidesPackage{pset}

\usepackage[hmargin=3cm,bottom=3.2cm,top=2.8cm]{geometry}  % page geometry

% Packages used while defining macros.
\usepackage{ifthen}

% Math things that should be loaded before mathspec.
\usepackage{amsmath,amsfonts,mathtools}


% XeTeX font madness
%
% Minion Pro and Myriad Pro are from Adobe
% CMU Concrete is special (optional?)
%
\usepackage{mathspec}  % includes fontspec
\usepackage{xltxtra}   % loads, among other things, xunicode and fontspec
%
% Placing this first without text figures ensures that digits for the math are
% set to the normal font when eulervm is loaded.
% \defaultfontfeatures{Ligatures=TeX} % same as Mapping=tex-text
\setmainfont[Ligatures=TeX]{Minion Pro}  % Note, reset below
\setsansfont[Ligatures=TeX,Scale=MatchLowercase]{Myriad Pro}
\setmonofont[Scale=MatchLowercase]{Consolas}
\setmathrm[Ligatures=TeX,Scale=MatchLowercase]{CMU Concrete}
%
% Make \oldstylenums add the right feature.
\renewcommand*{\oldstylenums}[1]{{\addfontfeature{Numbers=OldStyle} #1}}

% Math fonts
%
% eulervm must be loaded AFTER main text fonts, for mathrm etc.
% euler-digits also replaces comma and period, so don't use :-(
%
\usepackage[small,euler-hat-accent]{eulervm}
%
% Hacks to make accents work
% derived from eulervm's source
%
\DeclareSymbolFont{operatorT1}{T1}{\familydefault}{m}{n}
\DeclareMathAccent{\dot}{\mathalpha}{operatorT1}{10}
\DeclareMathAccent{\acute}{\mathalpha}{operatorT1}{1}
\DeclareMathAccent{\grave}{\mathalpha}{operatorT1}{0}
\DeclareMathAccent{\ddot}{\mathalpha}{operatorT1}{4}
\DeclareMathAccent{\tilde}{\mathalpha}{operatorT1}{3}
\DeclareMathAccent{\bar}{\mathalpha}{operatorT1}{9}
\DeclareMathAccent{\breve}{\mathalpha}{operatorT1}{8}
\DeclareMathAccent{\check}{\mathalpha}{operatorT1}{7}
%\DeclareMathAccent{\hat}{\mathalpha}{operatorT1}{2}
\DeclareMathAccent{\dot}{\mathalpha}{operatorT1}{10}

% Set oldstyle (text) figures after eulervm is loaded.
\setmainfont[Ligatures=TeX,Numbers=OldStyle]{Minion Pro}

% Spacing
\usepackage{setspace}
\setstretch{1.05}

%
% Define heading, problem, and solution environments for problem sets.
%

\newenvironment{heading}{
    \begin{flushleft}
    \vspace*{-25pt}
}{
    \vspace*{-0.5em}
    \hrulefill
    \end{flushleft}
    \aftergroup\@afterindentfalse
    \aftergroup\@afterheading
}

\newenvironment{problem}[2][]{
    \begin{trivlist}
    \setlength{\labelwidth}{2.0em}
    \item[\hfill\textbf{#1}]
    \ifthenelse{\equal{#2}{}}
        {}
        {\textbf{#2}\hspace{-0.5em}}
    \begin{it}
}{
    \end{it}
    \hfill\hspace*{-11pt}\raisebox{-2pt}{\ensuremath{\lrcorner\hspace*{-0.5pt}}}
    \end{trivlist}
}

\newenvironment{solution}{
    \begin{trivlist}
    \item[]
}{
    \hfill\ensuremath{\Box}
    \end{trivlist}
    \vspace{\baselineskip}
}

%
% Definitions for amsthm.
%
\usepackage{amsthm}
\theoremstyle{plain}
%
% Sometimes beamer defines theorem and definition.
%
\ifthenelse{\isundefined{\theorem}}{\newtheorem{theorem}{Theorem}}{}
\ifthenelse{\isundefined{\definition}}{\newtheorem{definition}{Definition}}{}
\newtheorem*{theorem*}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}


% Random other packages for math and things.
\usepackage{amssymb}
\usepackage[retainorgcmds]{IEEEtrantools} % nicer equation align
\usepackage{amsthm}
\usepackage{enumerate}                    % customization of item markers
\usepackage{graphicx}                     % images
\usepackage{float}                        % floating for figures, (esp. H option)
\usepackage{tikz-cd}                      % commutative diagrams



% starred newcommand behaves better for short commands (use by default)

% math symbols
\providecommand*{\K}{\ensuremath{\mathbb{K}}}
\providecommand*{\A}{\ensuremath{\mathbb{A}}}
\providecommand*{\N}{\ensuremath{\mathbb{N}}}
\providecommand*{\Z}{\ensuremath{\mathbb{Z}}}
\providecommand*{\Q}{\ensuremath{\mathbb{Q}}}
\providecommand*{\R}{\ensuremath{\mathbb{R}}}
\providecommand*{\C}{\ensuremath{\mathbb{C}}}
\providecommand*{\I}{\ensuremath{\mathbb{I}}}
\providecommand*{\V}{\ensuremath{\mathbb{V}}}
\newcommand*{\inv}[1]{#1^{-1}}
\newcommand*{\dual}[1]{#1^{\ast}}
\newcommand*{\dd}{\,d}
\newcommand*{\cinf}{C^\infty}
\newcommand*{\g}{\mathfrak{g}}
\newcommand*{\GL}{\mathfrak{GL}}
\newcommand*{\gl}{\mathfrak{gl}}
\newcommand*{\Proj}{\mathbb{P}}
\newcommand*{\iso}{\cong}
\newcommand*{\mat}[1]{ \left[\begin{matrix}#1\end{matrix}\right] }
\newcommand*{\smat}[1]{ \left(\begin{smallmatrix}#1\end{smallmatrix}\right) }
\newcommand*{\trans}[1]{{#1}^{T}}
\newcommand*{\conj}[1]{\overline{#1}}
\newcommand*{\osheaf}{\mathcal{O}}

% Math operators; see the package amsmath for documentation.
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\D}{D}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Ad}{Ad}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\Span}{Span}
\DeclareMathOperator{\rad}{rad}

% Suboptimal names.
\DeclareMathOperator{\image}{Im}
\DeclareMathOperator{\kernel}{Ker}
\DeclareMathOperator{\character}{char}
\DeclareMathOperator{\real}{Re}
\DeclareMathOperator{\imag}{Im}

% Math brackets
% See the package mathtools for documentation.
% Has optional argument \Xdel[size_cmd]{...}, with size_cmd = \big, \Big, \bigg, \Bigg
% Also defines \Xdel* macro, giving \left and \right modifiers.
\DeclarePairedDelimiter\sdel{[}{]}
\DeclarePairedDelimiter\adel{\langle}{\rangle}
\DeclarePairedDelimiter\cdel{\{}{\}}
\DeclarePairedDelimiter\pdel{\lparen}{\rparen}
\DeclarePairedDelimiter\vdel{\vert}{\vert}

%
% Other utility commands
%
\newcommand*{\lspace}{\vspace*{\baselineskip}}
\newcommand*{\nlspace}{\vspace*{-\baselineskip}}
\newcommand*{\nospace}{\setlength{\parskip}{0pt}\setlength{\itemsep}{0pt}}
\newcommand*{\lsc}[1]{\textsc{\lowercase{#1}}}
